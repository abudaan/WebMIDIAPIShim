{"version":3,"sources":["../../src/util/jzz.js"],"names":["createJzz","_version","_R","_orig","_ready","_queue","_err","prototype","_exec","length","x","shift","_bad","_hope","_or","apply","_push","func","arg","push","_slip","unshift","_pause","_resume","_break","err","_repair","_crash","_clone","_wait","obj","delay","setTimeout","wait","F","ret","_and","q","Function","console","log","and","or","_info","info","engine","sysex","name","_close","close","_tryAny","arr","self","e","toString","i","_pop","splice","_J","time","performance","now","_time","_initTimer","Date","_startTime","key","val","Object","Array","k","hasOwnProperty","ver","version","_outs","_ins","_postRefresh","_engine","_type","_sysex","inputs","outputs","_allOuts","_allIns","manufacturer","_virtual","type","_refresh","refresh","_filterList","slice","n","a","RegExp","test","_notFound","port","msg","_openMidiOut","pack","_openOut","openMidiOut","_M","_openMidiIn","_openIn","openMidiIn","_handles","_receive","_emit","send","MIDI","arguments","note","c","v","t","noteOn","noteOff","_stamp","m","_stamped","emit","_connect","_disconnect","connect","disconnect","_jzz","_tryNODE","module","exports","_initNode","require","_tryJazzPlugin","div","document","createElement","style","visibility","body","appendChild","width","height","classid","isJazz","_initJazzPlugin","_tryWebMIDI","navigator","requestMIDIAccess","onGood","midi","_initWebMIDI","onBad","opt","then","_tryWebMIDIsysex","_tryCRX","inst","eventHandle","getElementById","JSON","parse","innerText","removeEventListener","_initCRX","addEventListener","dispatchEvent","Event","_zeroBreak","_filterEngines","_filterEngineNames","degrade","_initNONE","web","dup","none","etc","head","tail","toLowerCase","concat","_initJZZ","_options","_initEngineJP","_inArr","_outArr","_inMap","_outMap","_main","MidiOutInfo","MidiInInfo","impl","_pool","_newPlugin","clients","_closeOut","plugin","MidiOutRaw","open","s","MidiOutOpen","MidiOutClose","_impl","_closeIn","handle","makeHandle","onmidi","MidiInOpen","MidiInClose","Time","plg","undefined","access","_access","forEach","dev","id","evt","call","data","onmidimessage","_msg","ready","CustomEvent","detail","_start","output","input","split","ins","j","outs","JZZ","createNew","SMPTE","reset","setType","getType","setHour","getHour","setMinute","getMinute","setSecond","getSecond","setFrame","getFrame","setQuarter","getQuarter","_fixDropFrame","second","frame","minute","isFullFrame","quarter","hour","RangeError","parseInt","incrFrame","decrFrame","incrQF","backwards","decrQF","_825","read","_","_b","_f","_a","_mtc","_hrtype","_dec","join","_from","noteValue","_throw","constructor","_noteNum","_noteMap","d","f","g","b","h","_ch","_7b","_lsb","_msb","_helper","aftertouch","control","program","pressure","pitchBend","bankMSB","bankLSB","modMSB","modLSB","breathMSB","breathLSB","footMSB","footLSB","portamentoMSB","portamentoLSB","volumeMSB","volumeLSB","balanceMSB","balanceLSB","panMSB","panLSB","expressionMSB","expressionLSB","damper","portamento","sostenuto","soft","allSoundOff","allNotesOff","mtc","songPosition","songSelect","tune","clock","start","continue","stop","active","sxIdRequest","sxFullFrame","_copyHelper","_channelMap","A","B","C","D","E","getChannel","setChannel","getNote","setNote","getVelocity","setVelocity","getSysExChannel","setSysExChannel","isNoteOn","isNoteOff","isSysEx","isFullSysEx","_hex","ss","_unstamp","indexOf","lib","registerMidiOut","registerMidiIn","_ac","getAudioContext","window","AudioContext","webkitAudioContext","createGain","createGainNode","_activateAudioContext","state","resume","osc","createOscillator","gain","setTargetAtTime","currentTime","destination","util","iosSound"],"mappings":"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","file":"jzz.js","sourcesContent":["function createJzz() {\n    var _version = '0.4.1';\n\n    // _R: common root for all async objects\n    function _R() {\n        this._orig = this;\n        this._ready = false;\n        this._queue = [];\n        this._err = [];\n    }\n    _R.prototype._exec = function () {\n        while (this._ready && this._queue.length) {\n            var x = this._queue.shift();\n            if (this._orig._bad) {\n                if (this._orig._hope && x[0] == _or) {\n                    this._orig._hope = false;\n                    x[0].apply(this, x[1]);\n                }\n                else {\n                    this._queue = [];\n                    this._orig._hope = false;\n                }\n            }\n            else if (x[0] != _or) {\n                x[0].apply(this, x[1]);\n            }\n        }\n    }\n    _R.prototype._push = function (func, arg) { this._queue.push([func, arg]); _R.prototype._exec.apply(this); }\n    _R.prototype._slip = function (func, arg) { this._queue.unshift([func, arg]); }\n    _R.prototype._pause = function () { this._ready = false; }\n    _R.prototype._resume = function () { this._ready = true; _R.prototype._exec.apply(this); }\n    _R.prototype._break = function (err) { this._orig._bad = true; this._orig._hope = true; if (err) this._orig._err.push(err); }\n    _R.prototype._repair = function () { this._orig._bad = false; }\n    _R.prototype._crash = function (err) { this._break(err); this._resume(); }\n    _R.prototype.err = function () { return _clone(this._err); }\n\n    function _wait(obj, delay) { setTimeout(function () { obj._resume(); }, delay); }\n    _R.prototype.wait = function (delay) {\n        if (!delay) return this;\n        function F() { } F.prototype = this._orig;\n        var ret = new F();\n        ret._ready = false;\n        ret._queue = [];\n        this._push(_wait, [ret, delay]);\n        return ret;\n    }\n\n    function _and(q) { if (q instanceof Function) q.apply(this); else console.log(q); }\n    _R.prototype.and = function (func) { this._push(_and, [func]); return this; }\n    function _or(q) { if (q instanceof Function) q.apply(this); else console.log(q); }\n    _R.prototype.or = function (func) { this._push(_or, [func]); return this; }\n\n    _R.prototype._info = {};\n    _R.prototype.info = function () {\n        var info = _clone(this._orig._info);\n        if (typeof info.engine == 'undefined') info.engine = 'none';\n        if (typeof info.sysex == 'undefined') info.sysex = true;\n        return info;\n    }\n    _R.prototype.name = function () { return this.info().name; }\n\n    function _close(obj) {\n        this._break('closed');\n        obj._resume();\n    }\n    _R.prototype.close = function () {\n        var ret = new _R();\n        if (this._close) this._push(this._close, []);\n        this._push(_close, [ret]);\n        return ret;\n    }\n\n    function _tryAny(arr) {\n        if (!arr.length) {\n            this._break();\n            return;\n        }\n        var func = arr.shift();\n        if (arr.length) {\n            var self = this;\n            this._slip(_or, [function () { _tryAny.apply(self, [arr]); }]);\n        }\n        try {\n            this._repair();\n            func.apply(this);\n        }\n        catch (e) {\n            this._break(e.toString());\n        }\n    }\n\n    function _push(arr, obj) {\n        for (var i = 0; i < arr.length; i++) if (arr[i] === obj) return;\n        arr.push(obj);\n    }\n    function _pop(arr, obj) {\n        for (var i = 0; i < arr.length; i++) if (arr[i] === obj) {\n            arr.splice(i, 1);\n            return;\n        }\n    }\n\n    // _J: JZZ object\n    function _J() {\n        _R.apply(this);\n    }\n    _J.prototype = new _R();\n\n    _J.prototype.time = function () { return 0; }\n    if (typeof performance != 'undefined' && performance.now) _J.prototype._time = function () { return performance.now(); }\n    function _initTimer() {\n        if (!_J.prototype._time) _J.prototype._time = function () { return Date.now(); }\n        _J.prototype._startTime = _J.prototype._time();\n        _J.prototype.time = function () { return _J.prototype._time() - _J.prototype._startTime; }\n    }\n\n    function _clone(obj, key, val) {\n        if (typeof key == 'undefined') return _clone(obj, [], []);\n        if (obj instanceof Object) {\n            for (var i = 0; i < key.length; i++) if (key[i] === obj) return val[i];\n            var ret;\n            if (obj instanceof Array) ret = []; else ret = {};\n            key.push(obj); val.push(ret);\n            for (var k in obj) if (obj.hasOwnProperty(k)) ret[k] = _clone(obj[k], key, val);\n            return ret;\n        }\n        return obj;\n    }\n    _J.prototype._info = { name: 'JZZ.js', ver: _version, version: _version };\n\n    var _outs = [];\n    var _ins = [];\n\n    function _postRefresh() {\n        this._info.engine = _engine._type;\n        this._info.version = _engine._version;\n        this._info.sysex = _engine._sysex;\n        this._info.inputs = [];\n        this._info.outputs = [];\n        _outs = [];\n        _ins = [];\n        _engine._allOuts = {};\n        _engine._allIns = {};\n        var i, x;\n        for (i = 0; i < _engine._outs.length; i++) {\n            x = _engine._outs[i];\n            x.engine = _engine;\n            _engine._allOuts[x.name] = x;\n            this._info.outputs.push({\n                name: x.name,\n                manufacturer: x.manufacturer,\n                version: x.version,\n                engine: _engine._type\n            });\n            _outs.push(x);\n        }\n        for (i = 0; i < _virtual._outs.length; i++) {\n            x = _virtual._outs[i];\n            this._info.outputs.push({\n                name: x.name,\n                manufacturer: x.manufacturer,\n                version: x.version,\n                engine: x.type\n            });\n            _outs.push(x);\n        }\n        for (i = 0; i < _engine._ins.length; i++) {\n            x = _engine._ins[i];\n            x.engine = _engine;\n            _engine._allIns[x.name] = x;\n            this._info.inputs.push({\n                name: x.name,\n                manufacturer: x.manufacturer,\n                version: x.version,\n                engine: _engine._type\n            });\n            _ins.push(x);\n        }\n        for (i = 0; i < _virtual._ins.length; i++) {\n            x = _virtual._ins[i];\n            this._info.inputs.push({\n                name: x.name,\n                manufacturer: x.manufacturer,\n                version: x.version,\n                engine: x.type\n            });\n            _ins.push(x);\n        }\n    }\n    function _refresh() {\n        this._slip(_postRefresh, []);\n        _engine._refresh();\n    }\n    _J.prototype.refresh = function () {\n        this._push(_refresh, []);\n        return this;\n    }\n\n    function _filterList(q, arr) {\n        if (typeof q == 'undefined') return arr.slice();\n        var i, n;\n        var a = [];\n        if (q instanceof RegExp) {\n            for (n = 0; n < arr.length; n++) if (q.test(arr[n].name)) a.push(arr[n]);\n            return a;\n        }\n        if (q instanceof Function) q = q(arr);\n        if (!(q instanceof Array)) q = [q];\n        for (i = 0; i < q.length; i++) {\n            for (n = 0; n < arr.length; n++) {\n                if (q[i] + '' === n + '' || q[i] === arr[n].name || (q[i] instanceof Object && q[i].name === arr[n].name)) a.push(arr[n]);\n            }\n        }\n        return a;\n    }\n\n    function _notFound(port, q) {\n        var msg;\n        if (q instanceof RegExp) msg = 'Port matching ' + q + ' not found';\n        else if (q instanceof Object || typeof q == 'undefined') msg = 'Port not found';\n        else msg = 'Port \"' + q + '\" not found';\n        port._crash(msg);\n    }\n\n    function _openMidiOut(port, arg) {\n        var arr = _filterList(arg, _outs);\n        if (!arr.length) { _notFound(port, arg); return; }\n        function pack(x) { return function () { x.engine._openOut(this, x.name); }; }\n        for (var i = 0; i < arr.length; i++) arr[i] = pack(arr[i]);\n        port._slip(_tryAny, [arr]);\n        port._resume();\n    }\n    _J.prototype.openMidiOut = function (arg) {\n        var port = new _M();\n        this._push(_refresh, []);\n        this._push(_openMidiOut, [port, arg]);\n        return port;\n    }\n\n    function _openMidiIn(port, arg) {\n        var arr = _filterList(arg, _ins);\n        if (!arr.length) { _notFound(port, arg); return; }\n        function pack(x) { return function () { x.engine._openIn(this, x.name); }; }\n        for (var i = 0; i < arr.length; i++) arr[i] = pack(arr[i]);\n        port._slip(_tryAny, [arr]);\n        port._resume();\n    }\n    _J.prototype.openMidiIn = function (arg) {\n        var port = new _M();\n        this._push(_refresh, []);\n        this._push(_openMidiIn, [port, arg]);\n        return port;\n    }\n\n    _J.prototype._close = function () {\n        _engine._close();\n    }\n\n    // _M: MIDI-In/Out object\n    function _M() {\n        _R.apply(this);\n        this._handles = [];\n        this._outs = [];\n    }\n    _M.prototype = new _R();\n\n    _M.prototype._receive = function (msg) { this._emit(msg); } // override!\n    function _receive(msg) { this._receive(msg); }\n    _M.prototype.send = function () {\n        this._push(_receive, [MIDI.apply(null, arguments)]);\n        return this;\n    }\n    _M.prototype.note = function (c, n, v, t) {\n        this.noteOn(c, n, v);\n        if (t) this.wait(t).noteOff(c, n);\n        return this;\n    }\n    _M.prototype._emit = function (msg) {\n        for (var i = 0; i < this._handles.length; i++) this._handles[i].apply(this, [MIDI(msg)._stamp(this)]);\n        for (var i = 0; i < this._outs.length; i++) {\n            var m = MIDI(msg);\n            if (!m._stamped(this._outs[i])) this._outs[i].send(m._stamp(this));\n        }\n    }\n    function _emit(msg) { this._emit(msg); }\n    _M.prototype.emit = function (msg) {\n        this._push(_emit, [msg]);\n        return this;\n    }\n    function _connect(arg) {\n        if (arg instanceof Function) _push(this._orig._handles, arg);\n        else _push(this._orig._outs, arg);\n    }\n    function _disconnect(arg) {\n        if (arg instanceof Function) _pop(this._orig._handles, arg);\n        else _pop(this._orig._outs, arg);\n    }\n    _M.prototype.connect = function (arg) {\n        this._push(_connect, [arg]);\n        return this;\n    }\n    _M.prototype.disconnect = function (arg) {\n        this._push(_disconnect, [arg]);\n        return this;\n    }\n\n    var _jzz;\n    var _engine = {};\n    var _virtual = { _outs: [], _ins: [] };\n\n    // Node.js\n    function _tryNODE() {\n        if (typeof module != 'undefined' && module.exports) {\n            _initNode(require('jazz-midi'));\n            return;\n        }\n        this._break();\n    }\n    // Jazz-Plugin\n    function _tryJazzPlugin() {\n        var div = document.createElement('div');\n        div.style.visibility = 'hidden';\n        document.body.appendChild(div);\n        var obj = document.createElement('object');\n        obj.style.visibility = 'hidden';\n        obj.style.width = '0px'; obj.style.height = '0px';\n        obj.classid = 'CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90';\n        obj.type = 'audio/x-jazz';\n        document.body.appendChild(obj);\n        if (obj.isJazz) {\n            _initJazzPlugin(obj);\n            return;\n        }\n        this._break();\n    }\n    // Web MIDI API\n    function _tryWebMIDI() {\n        if (navigator.requestMIDIAccess) {\n            var self = this;\n            function onGood(midi) {\n                _initWebMIDI(midi);\n                self._resume();\n            }\n            function onBad(msg) {\n                self._crash(msg);\n            }\n            var opt = {};\n            navigator.requestMIDIAccess(opt).then(onGood, onBad);\n            this._pause();\n            return;\n        }\n        this._break();\n    }\n    function _tryWebMIDIsysex() {\n        if (navigator.requestMIDIAccess) {\n            var self = this;\n            function onGood(midi) {\n                _initWebMIDI(midi, true);\n                self._resume();\n            }\n            function onBad(msg) {\n                self._crash(msg);\n            }\n            var opt = { sysex: true };\n            navigator.requestMIDIAccess(opt).then(onGood, onBad);\n            this._pause();\n            return;\n        }\n        this._break();\n    }\n    // Web-extension\n    function _tryCRX() {\n        var self = this;\n        var inst;\n        var msg;\n        function eventHandle(e) {\n            inst = true;\n            if (!msg) msg = document.getElementById('jazz-midi-msg');\n            if (!msg) return;\n            var a = [];\n            try { a = JSON.parse(msg.innerText); } catch (e) { }\n            msg.innerText = '';\n            document.removeEventListener('jazz-midi-msg', eventHandle);\n            if (a[0] === 'version') {\n                _initCRX(msg, a[2]);\n                self._resume();\n            }\n            else {\n                self._crash();\n            }\n        }\n        this._pause();\n        document.addEventListener('jazz-midi-msg', eventHandle);\n        try { document.dispatchEvent(new Event('jazz-midi')); } catch (e) { }\n        setTimeout(function () { if (!inst) self._crash(); }, 0);\n    }\n\n    function _zeroBreak() {\n        this._pause();\n        var self = this;\n        setTimeout(function () { self._crash(); }, 0);\n    }\n\n    function _filterEngines(opt) {\n        var ret = [_tryNODE, _zeroBreak];\n        var arr = _filterEngineNames(opt);\n        for (var i = 0; i < arr.length; i++) {\n            if (arr[i] == 'webmidi') {\n                if (opt && opt.sysex === true) ret.push(_tryWebMIDIsysex);\n                if (!opt || opt.sysex !== true || opt.degrade === true) ret.push(_tryWebMIDI);\n            }\n            else if (arr[i] == 'extension') ret.push(_tryCRX);\n            else if (arr[i] == 'plugin') ret.push(_tryJazzPlugin);\n        }\n        ret.push(_initNONE);\n        return ret;\n    }\n\n    function _filterEngineNames(opt) {\n        var web = ['extension', 'webmidi', 'plugin'];\n        if (!opt || !opt.engine) return web;\n        var arr = opt.engine instanceof Array ? opt.engine : [opt.engine];\n        var dup = {};\n        var none;\n        var etc;\n        var head = [];\n        var tail = [];\n        for (var i = 0; i < arr.length; i++) {\n            var name = arr[i].toString().toLowerCase();\n            if (dup[name]) continue;\n            dup[name] = true;\n            if (name === 'none') none = true;\n            if (name === 'etc') etc = true;\n            if (etc) tail.push(name); else head.push(name);\n            _pop(web, name);\n        }\n        if (etc || head.length || tail.length) none = false;\n        return none ? [] : head.concat(etc ? web : tail);\n    }\n\n    function _initJZZ(opt) {\n        _jzz = new _J();\n        _jzz._options = opt;\n        _jzz._push(_tryAny, [_filterEngines(opt)]);\n        _jzz.refresh();\n        _jzz._push(_initTimer, []);\n        _jzz._push(function () { if (!_outs.length && !_ins.length) this._break(); }, []);\n        _jzz._resume();\n    }\n\n    function _initNONE() {\n        _engine._type = 'none';\n        _engine._sysex = true;\n        _engine._refresh = function () { _engine._outs = []; _engine._ins = []; }\n    }\n    // common initialization for Jazz-Plugin and jazz-midi\n    function _initEngineJP() {\n        _engine._inArr = [];\n        _engine._outArr = [];\n        _engine._inMap = {};\n        _engine._outMap = {};\n        _engine._version = _engine._main.version;\n        _engine._sysex = true;\n        _engine._refresh = function () {\n            _engine._outs = [];\n            _engine._ins = [];\n            var i, x;\n            for (i = 0; (x = _engine._main.MidiOutInfo(i)).length; i++) {\n                _engine._outs.push({ type: _engine._type, name: x[0], manufacturer: x[1], version: x[2] });\n            }\n            for (i = 0; (x = _engine._main.MidiInInfo(i)).length; i++) {\n                _engine._ins.push({ type: _engine._type, name: x[0], manufacturer: x[1], version: x[2] });\n            }\n        }\n        _engine._openOut = function (port, name) {\n            var impl = _engine._outMap[name];\n            if (!impl) {\n                if (_engine._pool.length <= _engine._outArr.length) _engine._pool.push(_engine._newPlugin());\n                impl = {\n                    name: name,\n                    clients: [],\n                    info: {\n                        name: name,\n                        manufacturer: _engine._allOuts[name].manufacturer,\n                        version: _engine._allOuts[name].version,\n                        type: 'MIDI-out',\n                        sysex: _engine._sysex,\n                        engine: _engine._type\n                    },\n                    _close: function (port) { _engine._closeOut(port); },\n                    _receive: function (a) { this.plugin.MidiOutRaw(a.slice()); }\n                };\n                var plugin = _engine._pool[_engine._outArr.length];\n                impl.plugin = plugin;\n                _engine._outArr.push(impl);\n                _engine._outMap[name] = impl;\n            }\n            if (!impl.open) {\n                var s = impl.plugin.MidiOutOpen(name);\n                if (s !== name) {\n                    if (s) impl.plugin.MidiOutClose();\n                    port._break(); return;\n                }\n                impl.open = true;\n            }\n            port._orig._impl = impl;\n            _push(impl.clients, port._orig);\n            port._info = impl.info;\n            port._receive = function (arg) { impl._receive(arg); }\n            port._close = function () { impl._close(this); }\n        }\n        _engine._openIn = function (port, name) {\n            var impl = _engine._inMap[name];\n            if (!impl) {\n                if (_engine._pool.length <= _engine._inArr.length) _engine._pool.push(_engine._newPlugin());\n                impl = {\n                    name: name,\n                    clients: [],\n                    info: {\n                        name: name,\n                        manufacturer: _engine._allIns[name].manufacturer,\n                        version: _engine._allIns[name].version,\n                        type: 'MIDI-in',\n                        sysex: _engine._sysex,\n                        engine: _engine._type\n                    },\n                    _close: function (port) { _engine._closeIn(port); },\n                    handle: function (t, a) {\n                        for (var i = 0; i < this.clients.length; i++) {\n                            var msg = MIDI(a);\n                            this.clients[i]._emit(msg);\n                        }\n                    }\n                };\n                function makeHandle(x) { return function (t, a) { x.handle(t, a); }; }\n                impl.onmidi = makeHandle(impl);\n                var plugin = _engine._pool[_engine._inArr.length];\n                impl.plugin = plugin;\n                _engine._inArr.push(impl);\n                _engine._inMap[name] = impl;\n            }\n            if (!impl.open) {\n                var s = impl.plugin.MidiInOpen(name, impl.onmidi);\n                if (s !== name) {\n                    if (s) impl.plugin.MidiInClose();\n                    port._break(); return;\n                }\n                impl.open = true;\n            }\n            port._orig._impl = impl;\n            _push(impl.clients, port._orig);\n            port._info = impl.info;\n            port._close = function () { impl._close(this); }\n        }\n        _engine._closeOut = function (port) {\n            var impl = port._impl;\n            _pop(impl.clients, port._orig);\n            if (!impl.clients.length) {\n                impl.open = false;\n                impl.plugin.MidiOutClose();\n            }\n        }\n        _engine._closeIn = function (port) {\n            var impl = port._impl;\n            _pop(impl.clients, port._orig);\n            if (!impl.clients.length) {\n                impl.open = false;\n                impl.plugin.MidiInClose();\n            }\n        }\n        _engine._close = function () {\n            for (var i = 0; i < _engine._inArr.length; i++) if (_engine._inArr[i].open) _engine._inArr[i].plugin.MidiInClose();\n        }\n        _J.prototype._time = function () { return _engine._main.Time(); }\n    }\n\n    function _initNode(obj) {\n        _engine._type = 'node';\n        _engine._main = obj;\n        _engine._pool = [];\n        _engine._newPlugin = function () { return new obj.MIDI(); }\n        _initEngineJP();\n    }\n    function _initJazzPlugin(obj) {\n        _engine._type = 'plugin';\n        _engine._main = obj;\n        _engine._pool = [obj];\n        _engine._newPlugin = function () {\n            var plg = document.createElement('object');\n            plg.style.visibility = 'hidden';\n            plg.style.width = '0px'; obj.style.height = '0px';\n            plg.classid = 'CLSID:1ACE1618-1C7D-4561-AEE1-34842AA85E90';\n            plg.type = 'audio/x-jazz';\n            document.body.appendChild(plg);\n            return plg.isJazz ? plg : undefined;\n        }\n        _initEngineJP();\n    }\n    function _initWebMIDI(access, sysex) {\n        _engine._type = 'webmidi';\n        _engine._version = 43;\n        _engine._sysex = !!sysex;\n        _engine._access = access;\n        _engine._inMap = {};\n        _engine._outMap = {};\n        _engine._refresh = function () {\n            _engine._outs = [];\n            _engine._ins = [];\n            _engine._access.outputs.forEach(function (port, key) {\n                _engine._outs.push({ type: _engine._type, name: port.name, manufacturer: port.manufacturer, version: port.version });\n            });\n            _engine._access.inputs.forEach(function (port, key) {\n                _engine._ins.push({ type: _engine._type, name: port.name, manufacturer: port.manufacturer, version: port.version });\n            });\n        }\n        _engine._openOut = function (port, name) {\n            var impl = _engine._outMap[name];\n            if (!impl) {\n                impl = {\n                    name: name,\n                    clients: [],\n                    info: {\n                        name: name,\n                        manufacturer: _engine._allOuts[name].manufacturer,\n                        version: _engine._allOuts[name].version,\n                        type: 'MIDI-out',\n                        sysex: _engine._sysex,\n                        engine: _engine._type\n                    },\n                    _close: function (port) { _engine._closeOut(port); },\n                    _receive: function (a) { this.dev.send(a.slice()); }\n                };\n                var id, dev;\n                _engine._access.outputs.forEach(function (dev, key) {\n                    if (dev.name === name) impl.dev = dev;\n                });\n                if (impl.dev) {\n                    _engine._outMap[name] = impl;\n                }\n                else impl = undefined;\n            }\n            if (impl) {\n                if (impl.dev.open) impl.dev.open();\n                port._orig._impl = impl;\n                _push(impl.clients, port._orig);\n                port._info = impl.info;\n                port._receive = function (arg) { impl._receive(arg); }\n                port._close = function () { impl._close(this); }\n            }\n            else port._break();\n        }\n        _engine._openIn = function (port, name) {\n            var impl = _engine._inMap[name];\n            if (!impl) {\n                impl = {\n                    name: name,\n                    clients: [],\n                    info: {\n                        name: name,\n                        manufacturer: _engine._allIns[name].manufacturer,\n                        version: _engine._allIns[name].version,\n                        type: 'MIDI-in',\n                        sysex: _engine._sysex,\n                        engine: _engine._type\n                    },\n                    _close: function (port) { _engine._closeIn(port); },\n                    handle: function (evt) {\n                        for (var i = 0; i < this.clients.length; i++) {\n                            var msg = MIDI([].slice.call(evt.data));\n                            this.clients[i]._emit(msg);\n                        }\n                    }\n                };\n                var id, dev;\n                _engine._access.inputs.forEach(function (dev, key) {\n                    if (dev.name === name) impl.dev = dev;\n                });\n                if (impl.dev) {\n                    function makeHandle(x) { return function (evt) { x.handle(evt); }; }\n                    impl.dev.onmidimessage = makeHandle(impl);\n                    _engine._inMap[name] = impl;\n                }\n                else impl = undefined;\n            }\n            if (impl) {\n                if (impl.dev.open) impl.dev.open();\n                port._orig._impl = impl;\n                _push(impl.clients, port._orig);\n                port._info = impl.info;\n                port._close = function () { impl._close(this); }\n            }\n            else port._break();\n        }\n        _engine._closeOut = function (port) {\n            var impl = port._impl;\n            if (!impl.clients.length) {\n                if (impl.dev.close) impl.dev.close();\n            }\n            _pop(impl.clients, port._orig);\n        }\n        _engine._closeIn = function (port) {\n            var impl = port._impl;\n            _pop(impl.clients, port._orig);\n            if (!impl.clients.length) {\n                if (impl.dev.close) impl.dev.close();\n            }\n        }\n        _engine._close = function () {\n        }\n    }\n    function _initCRX(msg, ver) {\n        _engine._type = 'extension';\n        _engine._version = ver;\n        _engine._sysex = true;\n        _engine._pool = [];\n        _engine._inArr = [];\n        _engine._outArr = [];\n        _engine._inMap = {};\n        _engine._outMap = {};\n        _engine._msg = msg;\n        _engine._newPlugin = function () {\n            var plugin = { id: _engine._pool.length };\n            if (!plugin.id) plugin.ready = true;\n            else document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['new'] }));\n            _engine._pool.push(plugin);\n        }\n        _engine._newPlugin();\n        _engine._refresh = function () {\n            _engine._outs = [];\n            _engine._ins = [];\n            _jzz._pause();\n            document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['refresh'] }));\n        }\n        _engine._openOut = function (port, name) {\n            var impl = _engine._outMap[name];\n            if (!impl) {\n                if (_engine._pool.length <= _engine._outArr.length) _engine._newPlugin();\n                var plugin = _engine._pool[_engine._outArr.length];\n                impl = {\n                    name: name,\n                    clients: [],\n                    info: {\n                        name: name,\n                        manufacturer: _engine._allOuts[name].manufacturer,\n                        version: _engine._allOuts[name].version,\n                        type: 'MIDI-out',\n                        sysex: _engine._sysex,\n                        engine: _engine._type\n                    },\n                    _start: function () { document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['openout', plugin.id, name] })); },\n                    _close: function (port) { _engine._closeOut(port); },\n                    _receive: function (a) { var v = a.slice(); v.splice(0, 0, 'play', plugin.id); document.dispatchEvent(new CustomEvent('jazz-midi', { detail: v })); }\n                };\n                impl.plugin = plugin;\n                plugin.output = impl;\n                _engine._outArr.push(impl);\n                _engine._outMap[name] = impl;\n            }\n            port._orig._impl = impl;\n            _push(impl.clients, port._orig);\n            port._info = impl.info;\n            port._receive = function (arg) { impl._receive(arg); }\n            port._close = function () { impl._close(this); }\n            if (!impl.open) {\n                if (impl.plugin.ready) impl._start();\n                port._pause();\n            }\n        }\n        _engine._openIn = function (port, name) {\n            var impl = _engine._inMap[name];\n            if (!impl) {\n                if (_engine._pool.length <= _engine._inArr.length) _engine._newPlugin();\n                var plugin = _engine._pool[_engine._inArr.length];\n                impl = {\n                    name: name,\n                    clients: [],\n                    info: {\n                        name: name,\n                        manufacturer: _engine._allIns[name].manufacturer,\n                        version: _engine._allIns[name].version,\n                        type: 'MIDI-in',\n                        sysex: _engine._sysex,\n                        engine: _engine._type\n                    },\n                    _start: function () { document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['openin', plugin.id, name] })); },\n                    _close: function (port) { _engine._closeIn(port); }\n                };\n                impl.plugin = plugin;\n                plugin.input = impl;\n                _engine._inArr.push(impl);\n                _engine._inMap[name] = impl;\n            }\n            port._orig._impl = impl;\n            _push(impl.clients, port._orig);\n            port._info = impl.info;\n            port._close = function () { impl._close(this); }\n            if (!impl.open) {\n                if (impl.plugin.ready) impl._start();\n                port._pause();\n            }\n        }\n        _engine._closeOut = function (port) {\n            var impl = port._impl;\n            _pop(impl.clients, port._orig);\n            if (!impl.clients.length) {\n                impl.open = false;\n                document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['closeout', impl.plugin.id] }));\n            }\n        }\n        _engine._closeIn = function (port) {\n            var impl = port._impl;\n            _pop(impl.clients, port._orig);\n            if (!impl.clients.length) {\n                impl.open = false;\n                document.dispatchEvent(new CustomEvent('jazz-midi', { detail: ['closein', impl.plugin.id] }));\n            }\n        }\n        _engine._close = function () {\n        }\n        document.addEventListener('jazz-midi-msg', function (e) {\n            var v = _engine._msg.innerText.split('\\n');\n            _engine._msg.innerText = '';\n            for (var i = 0; i < v.length; i++) {\n                var a = [];\n                try { a = JSON.parse(v[i]); } catch (e) { }\n                if (!a.length) continue;\n                if (a[0] === 'refresh') {\n                    if (a[1].ins) {\n                        for (var j = 0; i < a[1].ins; i++) a[1].ins[j].type = _engine._type;\n                        _engine._ins = a[1].ins;\n                    }\n                    if (a[1].outs) {\n                        for (var j = 0; i < a[1].outs; i++) a[1].outs[j].type = _engine._type;\n                        _engine._outs = a[1].outs;\n                    }\n                    _jzz._resume();\n                }\n                else if (a[0] === 'version') {\n                    var plugin = _engine._pool[a[1]];\n                    if (plugin) {\n                        plugin.ready = true;\n                        if (plugin.input) plugin.input._start();\n                        if (plugin.output) plugin.output._start();\n                    }\n                }\n                else if (a[0] === 'openout') {\n                    var impl = _engine._pool[a[1]].output;\n                    if (impl) {\n                        if (a[2] == impl.name) {\n                            impl.open = true;\n                            if (impl.clients) for (var i = 0; i < impl.clients.length; i++) impl.clients[i]._resume();\n                        }\n                        else if (impl.clients) for (var i = 0; i < impl.clients.length; i++) impl.clients[i]._crash();\n                    }\n                }\n                else if (a[0] === 'openin') {\n                    var impl = _engine._pool[a[1]].input;\n                    if (impl) {\n                        if (a[2] == impl.name) {\n                            impl.open = true;\n                            if (impl.clients) for (var i = 0; i < impl.clients.length; i++) impl.clients[i]._resume();\n                        }\n                        else if (impl.clients) for (var i = 0; i < impl.clients.length; i++) impl.clients[i]._crash();\n                    }\n                }\n                else if (a[0] === 'midi') {\n                    var impl = _engine._pool[a[1]].input;\n                    if (impl && impl.clients) {\n                        for (var i = 0; i < impl.clients.length; i++) {\n                            var msg = MIDI(a.slice(3));\n                            impl.clients[i]._emit(msg);\n                        }\n                    }\n                }\n            }\n        });\n    }\n\n    var JZZ = function (opt) {\n        if (!_jzz) _initJZZ(opt);\n        return _jzz;\n    }\n    JZZ.info = function () { return _J.prototype.info(); }\n    JZZ.createNew = function (arg) {\n        var obj = new _M();\n        if (arg instanceof Object) for (var k in arg) if (arg.hasOwnProperty(k)) obj[k] = arg[k];\n        obj._resume();\n        return obj;\n    }\n    _J.prototype.createNew = JZZ.createNew;\n\n    // JZZ.SMPTE\n\n    function SMPTE() {\n        var self = this instanceof SMPTE ? this : self = new SMPTE();\n        SMPTE.prototype.reset.apply(self, arguments);\n        return self;\n    }\n    SMPTE.prototype.reset = function (arg) {\n        if (arg instanceof SMPTE) {\n            this.setType(arg.getType());\n            this.setHour(arg.getHour());\n            this.setMinute(arg.getMinute());\n            this.setSecond(arg.getSecond());\n            this.setFrame(arg.getFrame());\n            this.setQuarter(arg.getQuarter());\n            return this;\n        }\n        var arr = arg instanceof Array ? arg : arguments;\n        this.setType(arr[0]);\n        this.setHour(arr[1]);\n        this.setMinute(arr[2]);\n        this.setSecond(arr[3]);\n        this.setFrame(arr[4]);\n        this.setQuarter(arr[5]);\n        return this;\n    }\n    function _fixDropFrame() { if (this.type == 29.97 && !this.second && this.frame < 2 && this.minute % 10) this.frame = 2; }\n    SMPTE.prototype.isFullFrame = function () { return this.quarter == 0 || this.quarter == 4; }\n    SMPTE.prototype.getType = function () { return this.type; }\n    SMPTE.prototype.getHour = function () { return this.hour; }\n    SMPTE.prototype.getMinute = function () { return this.minute; }\n    SMPTE.prototype.getSecond = function () { return this.second; }\n    SMPTE.prototype.getFrame = function () { return this.frame; }\n    SMPTE.prototype.getQuarter = function () { return this.quarter; }\n    SMPTE.prototype.setType = function (x) {\n        if (typeof x == 'undefined' || x == 24) this.type = 24;\n        else if (x == 25) this.type = 25;\n        else if (x == 29.97) { this.type = 29.97; _fixDropFrame.apply(this); }\n        else if (x == 30) this.type = 30;\n        else throw RangeError('Bad SMPTE frame rate: ' + x);\n        if (this.frame >= this.type) this.frame = this.type == 29.97 ? 29 : this.type - 1;\n        return this;\n    }\n    SMPTE.prototype.setHour = function (x) {\n        if (typeof x == 'undefined') x = 0;\n        if (x != parseInt(x) || x < 0 || x >= 24) throw RangeError('Bad SMPTE hours value: ' + x);\n        this.hour = x;\n        return this;\n    }\n    SMPTE.prototype.setMinute = function (x) {\n        if (typeof x == 'undefined') x = 0;\n        if (x != parseInt(x) || x < 0 || x >= 60) throw RangeError('Bad SMPTE minutes value: ' + x);\n        this.minute = x;\n        _fixDropFrame.apply(this);\n        return this;\n    }\n    SMPTE.prototype.setSecond = function (x) {\n        if (typeof x == 'undefined') x = 0;\n        if (x != parseInt(x) || x < 0 || x >= 60) throw RangeError('Bad SMPTE seconds value: ' + x);\n        this.second = x;\n        _fixDropFrame.apply(this);\n        return this;\n    }\n    SMPTE.prototype.setFrame = function (x) {\n        if (typeof x == 'undefined') x = 0;\n        if (x != parseInt(x) || x < 0 || x >= this.type) throw RangeError('Bad SMPTE frame number: ' + x);\n        this.frame = x;\n        _fixDropFrame.apply(this);\n        return this;\n    }\n    SMPTE.prototype.setQuarter = function (x) {\n        if (typeof x == 'undefined') x = 0;\n        if (x != parseInt(x) || x < 0 || x >= 8) throw RangeError('Bad SMPTE quarter frame: ' + x);\n        this.quarter = x;\n        return this;\n    }\n    SMPTE.prototype.incrFrame = function () {\n        this.frame++;\n        if (this.frame >= this.type) {\n            this.frame = 0;\n            this.second++;\n            if (this.second >= 60) {\n                this.second = 0;\n                this.minute++;\n                if (this.minute >= 60) {\n                    this.minute = 0;\n                    this.hour = this.hour >= 23 ? 0 : this.hour + 1;\n                }\n            }\n        }\n        _fixDropFrame.apply(this);\n        return this;\n    }\n    SMPTE.prototype.decrFrame = function () {\n        if (!this.second && this.frame == 2 && this.type == 29.97 && this.minute % 10) this.frame = 0; // drop-frame\n        this.frame--;\n        if (this.frame < 0) {\n            this.frame = this.type == 29.97 ? 29 : this.type - 1;\n            this.second--;\n            if (this.second < 0) {\n                this.second = 59;\n                this.minute--;\n                if (this.minute < 0) {\n                    this.minute = 59;\n                    this.hour = this.hour ? this.hour - 1 : 23;\n                }\n            }\n        }\n        return this;\n    }\n    SMPTE.prototype.incrQF = function () {\n        this.backwards = false;\n        this.quarter = (this.quarter + 1) & 7;\n        if (this.quarter == 0 || this.quarter == 4) this.incrFrame();\n        return this;\n    }\n    SMPTE.prototype.decrQF = function () {\n        this.backwards = true;\n        this.quarter = (this.quarter + 7) & 7;\n        if (this.quarter == 3 || this.quarter == 7) this.decrFrame();\n        return this;\n    }\n    function _825(a) { return [[24, 25, 29.97, 30][(a[7] >> 1) & 3], ((a[7] & 1) << 4) | a[6], (a[5] << 4) | a[4], (a[3] << 4) | a[2], (a[1] << 4) | a[0]]; }\n    SMPTE.prototype.read = function (m) {\n        if (!(m instanceof MIDI)) m = MIDI.apply(null, arguments);\n        if (m[0] == 0xf0 && m[1] == 0x7f && m[3] == 1 && m[4] == 1 && m[9] == 0xf7) {\n            this.type = [24, 25, 29.97, 30][(m[5] >> 5) & 3];\n            this.hour = m[5] & 31;\n            this.minute = m[6];\n            this.second = m[7];\n            this.frame = m[8];\n            this.quarter = 0;\n            this._ = undefined;\n            this._b = undefined;\n            this._f = undefined;\n            return true;\n        }\n        if (m[0] == 0xf1 && typeof m[1] != 'undefined') {\n            var q = m[1] >> 4;\n            var n = m[1] & 15;\n            if (q == 0) {\n                if (this._ == 7) {\n                    if (this._f == 7) {\n                        this.reset(_825(this._a));\n                        this.incrFrame();\n                    }\n                    this.incrFrame();\n                }\n            }\n            else if (q == 3) {\n                if (this._ == 4) {\n                    this.decrFrame();\n                }\n            }\n            else if (q == 4) {\n                if (this._ == 3) {\n                    this.incrFrame();\n                }\n            }\n            else if (q == 7) {\n                if (this._ === 0) {\n                    if (this._b === 0) {\n                        this.reset(_825(this._a));\n                        this.decrFrame();\n                    }\n                    this.decrFrame();\n                }\n            }\n            if (!this._a) this._a = [];\n            this._a[q] = n;\n            this._f = this._f === q - 1 || q == 0 ? q : undefined;\n            this._b = this._b === q + 1 || q == 7 ? q : undefined;\n            this._ = q;\n            this.quarter = q;\n            return true;\n        }\n        return false;\n    }\n    function _mtc(t) {\n        if (!t.backwards && t.quarter >= 4) t.decrFrame(); // continue encoding previous frame\n        else if (t.backwards && t.quarter < 4) t.incrFrame();\n        var ret;\n        switch (t.quarter >> 1) {\n        case 0: ret = t.frame; break;\n        case 1: ret = t.second; break;\n        case 2: ret = t.minute; break;\n        default: ret = t.hour;\n        }\n        if (t.quarter & 1) ret >>= 4;\n        else ret &= 15;\n        if (t.quarter == 7) {\n            if (t.type == 25) ret |= 2;\n            else if (t.type == 29.97) ret |= 4;\n            else if (t.type == 30) ret |= 6;\n        }\n        if (!t.backwards && t.quarter >= 4) t.incrFrame();\n        else if (t.backwards && t.quarter < 4) t.decrFrame();\n        return ret | (t.quarter << 4);\n    }\n    function _hrtype(t) {\n        if (t.type == 25) return t.hour | 0x20;\n        if (t.type == 29.97) return t.hour | 0x40;\n        if (t.type == 30) return t.hour | 0x60;\n        return t.hour;\n    }\n    function _dec(x) { return x < 10 ? '0' + x : x; }\n    SMPTE.prototype.toString = function () { return [_dec(this.hour), _dec(this.minute), _dec(this.second), _dec(this.frame)].join(':'); }\n    JZZ.SMPTE = SMPTE;\n\n    // JZZ.MIDI\n\n    function MIDI(arg) {\n        var self = this instanceof MIDI ? this : self = new MIDI();\n        self._from = arg instanceof MIDI ? arg._from.slice() : [];\n        if (!arguments.length) return self;\n        var arr = arg instanceof Array ? arg : arguments;\n        for (var i = 0; i < arr.length; i++) {\n            var n = arr[i];\n            if (i == 1 && self[0] >= 0x80 && self[0] <= 0xAF) n = MIDI.noteValue(n);\n            if (n != parseInt(n) || n < 0 || n > 255) _throw(arr[i]);\n            self.push(n);\n        }\n        return self;\n    }\n    MIDI.prototype = [];\n    MIDI.prototype.constructor = MIDI;\n    var _noteNum = {};\n    MIDI.noteValue = function (x) { return _noteNum[x.toString().toLowerCase()]; }\n\n    var _noteMap = { c: 0, d: 2, e: 4, f: 5, g: 7, a: 9, b: 11, h: 11 };\n    for (var k in _noteMap) {\n        if (!_noteMap.hasOwnProperty(k)) continue;\n        for (var n = 0; n < 12; n++) {\n            var m = _noteMap[k] + n * 12;\n            if (m > 127) break;\n            _noteNum[k + n] = m;\n            if (m > 0) { _noteNum[k + 'b' + n] = m - 1; _noteNum[k + 'bb' + n] = m - 2; }\n            if (m < 127) { _noteNum[k + '#' + n] = m + 1; _noteNum[k + '##' + n] = m + 2; }\n        }\n    }\n    for (var n = 0; n < 128; n++) _noteNum[n] = n;\n    function _throw(x) { throw RangeError('Bad MIDI value: ' + x); }\n    function _ch(n) { if (n != parseInt(n) || n < 0 || n > 0xf) _throw(n); return n; }\n    function _7b(n) { if (n != parseInt(n) || n < 0 || n > 0x7f) _throw(n); return n; }\n    function _lsb(n) { if (n != parseInt(n) || n < 0 || n > 0x3fff) _throw(n); return n & 0x7f; }\n    function _msb(n) { if (n != parseInt(n) || n < 0 || n > 0x3fff) _throw(n); return n >> 7; }\n    var _helper = {\n        noteOff: function (c, n) { return [0x80 + _ch(c), _7b(MIDI.noteValue(n)), 0]; },\n        noteOn: function (c, n, v) { return [0x90 + _ch(c), _7b(MIDI.noteValue(n)), _7b(v)]; },\n        aftertouch: function (c, n, v) { return [0xA0 + _ch(c), _7b(MIDI.noteValue(n)), _7b(v)]; },\n        control: function (c, n, v) { return [0xB0 + _ch(c), _7b(n), _7b(v)]; },\n        program: function (c, n) { return [0xC0 + _ch(c), _7b(n)]; },\n        pressure: function (c, n) { return [0xD0 + _ch(c), _7b(n)]; },\n        pitchBend: function (c, n) { return [0xE0 + _ch(c), _lsb(n), _msb(n)]; },\n        bankMSB: function (c, n) { return [0xB0 + _ch(c), 0x00, _7b(n)]; },\n        bankLSB: function (c, n) { return [0xB0 + _ch(c), 0x20, _7b(n)]; },\n        modMSB: function (c, n) { return [0xB0 + _ch(c), 0x01, _7b(n)]; },\n        modLSB: function (c, n) { return [0xB0 + _ch(c), 0x21, _7b(n)]; },\n        breathMSB: function (c, n) { return [0xB0 + _ch(c), 0x02, _7b(n)]; },\n        breathLSB: function (c, n) { return [0xB0 + _ch(c), 0x22, _7b(n)]; },\n        footMSB: function (c, n) { return [0xB0 + _ch(c), 0x04, _7b(n)]; },\n        footLSB: function (c, n) { return [0xB0 + _ch(c), 0x24, _7b(n)]; },\n        portamentoMSB: function (c, n) { return [0xB0 + _ch(c), 0x05, _7b(n)]; },\n        portamentoLSB: function (c, n) { return [0xB0 + _ch(c), 0x25, _7b(n)]; },\n        volumeMSB: function (c, n) { return [0xB0 + _ch(c), 0x07, _7b(n)]; },\n        volumeLSB: function (c, n) { return [0xB0 + _ch(c), 0x27, _7b(n)]; },\n        balanceMSB: function (c, n) { return [0xB0 + _ch(c), 0x08, _7b(n)]; },\n        balanceLSB: function (c, n) { return [0xB0 + _ch(c), 0x28, _7b(n)]; },\n        panMSB: function (c, n) { return [0xB0 + _ch(c), 0x0A, _7b(n)]; },\n        panLSB: function (c, n) { return [0xB0 + _ch(c), 0x2A, _7b(n)]; },\n        expressionMSB: function (c, n) { return [0xB0 + _ch(c), 0x0B, _7b(n)]; },\n        expressionLSB: function (c, n) { return [0xB0 + _ch(c), 0x2B, _7b(n)]; },\n        damper: function (c, b) { return [0xB0 + _ch(c), 0x40, b ? 127 : 0]; },\n        portamento: function (c, b) { return [0xB0 + _ch(c), 0x41, b ? 127 : 0]; },\n        sostenuto: function (c, b) { return [0xB0 + _ch(c), 0x42, b ? 127 : 0]; },\n        soft: function (c, b) { return [0xB0 + _ch(c), 0x43, b ? 127 : 0]; },\n        allSoundOff: function (c) { return [0xB0 + _ch(c), 0x78, 0]; },\n        allNotesOff: function (c) { return [0xB0 + _ch(c), 0x7b, 0]; },\n        mtc: function (t) { return [0xF1, _mtc(t)]; },\n        songPosition: function (n) { return [0xF2, _lsb(n), _msb(n)]; },\n        songSelect: function (n) { return [0xF3, _7b(n)]; },\n        tune: function () { return [0xF6]; },\n        clock: function () { return [0xF8]; },\n        start: function () { return [0xFA]; },\n        continue: function () { return [0xFB]; },\n        stop: function () { return [0xFC]; },\n        active: function () { return [0xFE]; },\n        sxIdRequest: function () { return [0xF0, 0x7E, 0x7F, 0x06, 0x01, 0xF7]; },\n        sxFullFrame: function (t) { return [0xF0, 0x7F, 0x7F, 0x01, 0x01, _hrtype(t), t.getMinute(), t.getSecond(), t.getFrame(), 0xF7]; },\n        reset: function () { return [0xFF]; }\n    };\n    function _copyHelper(name, func) {\n        MIDI[name] = function () { return new MIDI(func.apply(0, arguments)); };\n        _M.prototype[name] = function () { this.send(func.apply(0, arguments)); return this; };\n    }\n    for (var k in _helper) if (_helper.hasOwnProperty(k)) _copyHelper(k, _helper[k]);\n\n    var _channelMap = { a: 10, b: 11, c: 12, d: 13, e: 14, f: 15, A: 10, B: 11, C: 12, D: 13, E: 14, F: 15 };\n    for (var k = 0; k < 16; k++) _channelMap[k] = k;\n    MIDI.prototype.getChannel = function () {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x80 || c > 0xef) return;\n        return c & 15;\n    }\n    MIDI.prototype.setChannel = function (x) {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x80 || c > 0xef) return this;\n        x = _channelMap[x];\n        if (typeof x != 'undefined') this[0] = (c & 0xf0) | x;\n        return this;\n    }\n    MIDI.prototype.getNote = function () {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x80 || c > 0xaf) return;\n        return this[1];\n    }\n    MIDI.prototype.setNote = function (x) {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x80 || c > 0xaf) return this;\n        x = MIDI.noteValue(x);\n        if (typeof x != 'undefined') this[1] = x;\n        return this;\n    }\n    MIDI.prototype.getVelocity = function () {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x90 || c > 0x9f) return;\n        return this[2];\n    }\n    MIDI.prototype.setVelocity = function (x) {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x90 || c > 0x9f) return this;\n        x = parseInt(x);\n        if (x >= 0 && x < 128) this[2] = x;\n        return this;\n    }\n    MIDI.prototype.getSysExChannel = function () {\n        if (this[0] == 0xf0) return this[2];\n    }\n    MIDI.prototype.setSysExChannel = function (x) {\n        if (this[0] == 0xf0 && this.length > 2) {\n            x = parseInt(x);\n            if (x >= 0 && x < 128) this[2] = x;\n        }\n        return this;\n    }\n    MIDI.prototype.isNoteOn = function () {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x90 || c > 0x9f) return false;\n        return this[2] > 0 ? true : false;\n    }\n    MIDI.prototype.isNoteOff = function () {\n        var c = this[0];\n        if (typeof c == 'undefined' || c < 0x80 || c > 0x9f) return false;\n        if (c < 0x90) return true;\n        return this[2] == 0 ? true : false;\n    }\n    MIDI.prototype.isSysEx = function () {\n        return this[0] == 0xf0;\n    }\n    MIDI.prototype.isFullSysEx = function () {\n        return this[0] == 0xf0 && this[this.length - 1] == 0xf7;\n    }\n\n    function _hex(x) {\n        var a = [];\n        for (var i = 0; i < x.length; i++) {\n            a[i] = (x[i] < 16 ? '0' : '') + x[i].toString(16);\n        }\n        return a.join(' ');\n    }\n    MIDI.prototype.toString = function () {\n        if (!this.length) return 'empty';\n        var s = _hex(this);\n        if (this[0] < 0x80) return s;\n        var ss = {\n            241: 'MIDI Time Code',\n            242: 'Song Position',\n            243: 'Song Select',\n            244: 'Undefined',\n            245: 'Undefined',\n            246: 'Tune request',\n            248: 'Timing clock',\n            249: 'Undefined',\n            250: 'Start',\n            251: 'Continue',\n            252: 'Stop',\n            253: 'Undefined',\n            254: 'Active Sensing',\n            255: 'Reset'\n        }[this[0]];\n        if (ss) return s + ' -- ' + ss;\n        var c = this[0] >> 4;\n        ss = { 8: 'Note Off', 10: 'Aftertouch', 12: 'Program Change', 13: 'Channel Aftertouch', 14: 'Pitch Wheel' }[c];\n        if (ss) return s + ' -- ' + ss;\n        if (c == 9) return s + ' -- ' + (this[2] ? 'Note On' : 'Note Off');\n        if (c != 11) return s;\n        ss = {\n            0: 'Bank Select MSB',\n            1: 'Modulation Wheel MSB',\n            2: 'Breath Controller MSB',\n            4: 'Foot Controller MSB',\n            5: 'Portamento Time MSB',\n            6: 'Data Entry MSB',\n            7: 'Channel Volume MSB',\n            8: 'Balance MSB',\n            10: 'Pan MSB',\n            11: 'Expression Controller MSB',\n            12: 'Effect Control 1 MSB',\n            13: 'Effect Control 2 MSB',\n            16: 'General Purpose Controller 1 MSB',\n            17: 'General Purpose Controller 2 MSB',\n            18: 'General Purpose Controller 3 MSB',\n            19: 'General Purpose Controller 4 MSB',\n            32: 'Bank Select LSB',\n            33: 'Modulation Wheel LSB',\n            34: 'Breath Controller LSB',\n            36: 'Foot Controller LSB',\n            37: 'Portamento Time LSB',\n            38: 'Data Entry LSB',\n            39: 'Channel Volume LSB',\n            40: 'Balance LSB',\n            42: 'Pan LSB',\n            43: 'Expression Controller LSB',\n            44: 'Effect control 1 LSB',\n            45: 'Effect control 2 LSB',\n            48: 'General Purpose Controller 1 LSB',\n            49: 'General Purpose Controller 2 LSB',\n            50: 'General Purpose Controller 3 LSB',\n            51: 'General Purpose Controller 4 LSB',\n            64: 'Damper Pedal On/Off',\n            65: 'Portamento On/Off',\n            66: 'Sostenuto On/Off',\n            67: 'Soft Pedal On/Off',\n            68: 'Legato Footswitch',\n            69: 'Hold 2',\n            70: 'Sound Controller 1',\n            71: 'Sound Controller 2',\n            72: 'Sound Controller 3',\n            73: 'Sound Controller 4',\n            74: 'Sound Controller 5',\n            75: 'Sound Controller 6',\n            76: 'Sound Controller 7',\n            77: 'Sound Controller 8',\n            78: 'Sound Controller 9',\n            79: 'Sound Controller 10',\n            80: 'General Purpose Controller 5',\n            81: 'General Purpose Controller 6',\n            82: 'General Purpose Controller 7',\n            83: 'General Purpose Controller 8',\n            84: 'Portamento Control',\n            88: 'High Resolution Velocity Prefix',\n            91: 'Effects 1 Depth',\n            92: 'Effects 2 Depth',\n            93: 'Effects 3 Depth',\n            94: 'Effects 4 Depth',\n            95: 'Effects 5 Depth',\n            96: 'Data Increment',\n            97: 'Data Decrement',\n            98: 'Non-Registered Parameter Number LSB',\n            99: 'Non-Registered Parameter Number MSB',\n            100: 'Registered Parameter Number LSB',\n            101: 'Registered Parameter Number MSB',\n            120: 'All Sound Off',\n            121: 'Reset All Controllers',\n            122: 'Local Control On/Off',\n            123: 'All Notes Off',\n            124: 'Omni Mode Off',\n            125: 'Omni Mode On',\n            126: 'Mono Mode On',\n            127: 'Poly Mode On'\n        }[this[1]];\n        if (!ss) ss = 'Undefined';\n        return s + ' -- ' + ss;\n    }\n    MIDI.prototype._stamp = function (obj) { this._from.push(obj._orig ? obj._orig : obj); return this; }\n    MIDI.prototype._unstamp = function (obj) {\n        if (typeof obj == 'undefined') this._from = [];\n        else {\n            if (obj._orig) obj = obj._orig;\n            var i = this._from.indexOf(obj);\n            if (i > -1) this._from.splice(i, 1);\n        }\n        return this;\n    }\n    MIDI.prototype._stamped = function (obj) {\n        if (obj._orig) obj = obj._orig;\n        for (var i = 0; i < this._from.length; i++) if (this._from[i] == obj) return true;\n        return false;\n    }\n\n    JZZ.MIDI = MIDI;\n\n    JZZ.lib = {};\n    JZZ.lib.openMidiOut = function (name, engine) {\n        var port = new _M();\n        engine._openOut(port, name);\n        return port;\n    }\n    JZZ.lib.openMidiIn = function (name, engine) {\n        var port = new _M();\n        engine._openIn(port, name);\n        return port;\n    }\n    JZZ.lib.registerMidiOut = function (name, engine) {\n        var x = engine._info(name);\n        for (var i = 0; i < _virtual._outs.length; i++) if (_virtual._outs[i].name == x.name) return false;\n        x.engine = engine;\n        _virtual._outs.push(x);\n        if (_jzz && _jzz._bad) { _jzz._repair(); _jzz._resume(); }\n        return true;\n    }\n    JZZ.lib.registerMidiIn = function (name, engine) {\n        var x = engine._info(name);\n        for (var i = 0; i < _virtual._ins.length; i++) if (_virtual._ins[i].name == x.name) return false;\n        x.engine = engine;\n        _virtual._ins.push(x);\n        if (_jzz && _jzz._bad) { _jzz._repair(); _jzz._resume(); }\n        return true;\n    }\n    var _ac;\n    JZZ.lib.getAudioContext = function () { return _ac; }\n    if (typeof window !== \"undefined\") {\n        var AudioContext = window.AudioContext || window.webkitAudioContext;\n        if (AudioContext) _ac = new AudioContext();\n        if (_ac && !_ac.createGain) _ac.createGain = _ac.createGainNode;\n        function _activateAudioContext() {\n            if (_ac.state != 'running') {\n                _ac.resume();\n                var osc = _ac.createOscillator();\n                var gain = _ac.createGain();\n                gain.gain.setTargetAtTime(0, _ac.currentTime, 0.01);\n                osc.connect(gain);\n                gain.connect(_ac.destination);\n                if (!osc.start) osc.start = osc.noteOn;\n                if (!osc.stop) osc.stop = osc.noteOff;\n                osc.start(.1); osc.stop(0.11);\n            }\n            else {\n                document.removeEventListener('touchend', _activateAudioContext);\n                document.removeEventListener('mousedown', _activateAudioContext);\n                document.removeEventListener('keydown', _activateAudioContext);\n            }\n        }\n        document.addEventListener('touchend', _activateAudioContext);\n        document.addEventListener('mousedown', _activateAudioContext);\n        document.addEventListener('keydown', _activateAudioContext);\n        _activateAudioContext();\n    }\n\n    JZZ.util = {};\n    JZZ.util.iosSound = function () {\n        // deprecated. will be removed in next version\n    }\n    return JZZ;\n}\n\nmodule.exports = createJzz();\n"]}